IAM-Database:
  image: rancher/external-service
  labels:
    project.service.name: iam-database
    project.name: cis-urs
    project.stack: urs

Directory:
  image: rancher/external-service
  labels:
    project.service.name: directory
    project.name: cis-urs
    project.stack: urs

Entrust-CA1-Manager:
  image: rancher/external-service
  labels:
    project.service.name: entrust-ca1-manager
    project.name: cis-urs
    project.stack: urs

Entrust-CA2-Manager:
  image: rancher/external-service
  labels:
    project.service.name: entrust-ca2-manager
    project.name: cis-urs
    project.stack: urs

Entrust-CA3-Manager:
  image: rancher/external-service
  labels:
    project.service.name: entrust-ca3-manager
    project.name: cis-urs
    project.stack: urs

Outbound-Messaging-Service:
  image: rancher/external-service
  labels:
    project.service.name: outbound-messaging-service
    project.name: cis-urs
    project.stack: urs

WebSessionStore:
  image: rancher/external-service
  labels:
    project.service.name: web-session-store
    project.name: cis-urs
    project.stack: urs

RedisSessionStore:
  image: rancher/external-service
  labels:
    project.service.name: redis-session-store
    project.name: cis-urs
    project.stack: urs

LB-BusinessServices:
  expose:
  - 8080:8080
  ports:
  - 8080:8080
  labels:
    io.rancher.loadbalancer.target.URS-BusinessService: 8080/ursbusservice=8080
    io.rancher.loadbalancer.target.EPR-WebFrontEnd: 8080/eprwebapp=8080
    io.rancher.loadbalancer.target.Portal: 8080/portal=8080
    io.rancher.loadbalancer.target.OSCAR-BusinessService: 8080/orsservice=8080
    io.rancher.loadbalancer.target.Integration: 8080/cxf=8181
    io.rancher.loadbalancer.target.ReportingService: 8080/iamrepservice=8080
    io.rancher.loadbalancer.target.Audit: 8080/auditloggerws=8080
    io.rancher.loadbalancer.target.SCEP: 8080/mobileconfig=9098
    io.rancher.loadbalancer.target.UID-Service: 8080/uidservice=8080
    io.rancher.loadbalancer.target.GuvnorService: 8080/guvnor-5.5.0.Final-tomcat-6.0=8080
    io.rancher.loadbalancer.target.OMS-BusinessService: 8080/omsbusservice=8080
    io.rancher.loadbalancer.target.ID-StoreSyncService: 8080/idstoresyncmanager=8080,8080/openidm=8081
    io.rancher.loadbalancer.target.CC-CheckerService: 8080/cccheckerservice/8080
    io.rancher.loadbalancer.target.Outbound-Messaging-Service: 8080/esrNotification=8080,8080/eprNotification=8080,8080/AckRecord=8104
    io.rancher.loadbalancer.target.URS-WebFrontEnd: 8080/urswebapp=8080
    io.rancher.loadbalancer.target.EPR-BusinessService: 8080/eprbusservice=8080
    io.rancher.loadbalancer.target.RulesService: 8080/rulesservice=8080
    io.rancher.loadbalancer.target.CMS-BusinessService: 8080/cmsbusservice=8080
    io.rancher.loadbalancer.target.EmailService: 8080/emailservice=8080
    environment_name: ${env_shortcode}
    service_name: LB-BusinessServices
    project.service.name: lb-business-services
    project.name: cis-urs
    project.stack: urs
  tty: true
  image: rancher/load-balancer-service
  links:
  - UID-Service:UID-Service
  - URS-WebFrontEnd:URS-WebFrontEnd
  - OSCAR-BusinessService:OSCAR-BusinessService
  - EPR-BusinessService:EPR-BusinessService
  - RulesService:RulesService
  - SCEP:SCEP
  - ID-StoreSyncService:ID-StoreSyncService
  - CC-CheckerService:CC-CheckerService
  - ReportingService:ReportingService
  - Outbound-Messaging-Service:Outbound-Messaging-Service
  - Integration:Integration
  - GuvnorService:GuvnorService
  - CMS-BusinessService:CMS-BusinessService
  - Audit:Audit
  - EPR-WebFrontEnd:EPR-WebFrontEnd
  - OMS-BusinessService:OMS-BusinessService
  - URS-BusinessService:URS-BusinessService
  - Portal:Portal
  - EmailService:EmailService
  stdin_open: true

LB-Secure:
  expose:
  - 8443:8443/tcp
  labels:
    environment_name: ${env_shortcode}
    service_name: LB-Secure
    project.service.name: lb-secure
    project.name: cis-urs
    project.stack: urs
  image: rancher/load-balancer-service
  tty: true
  stdin_open: true
  links:
  - SecureAudit:SecureAudit

Audit:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: Audit
    project.service.name: audit
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-audit:${app_version}
  environment:
    JAVA_OPTS: -server -Xms60m -Xms150m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

GuvnorService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: GuvnorService
    project.service.name: guvnor-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 7491026944
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-guvnor:${app_version}
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

CMS-BusinessService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: CMS-BusinessService
    project.service.name: cms-business-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 300000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  privileged: true
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    ENTRUST_AUTHCA_CA_PORT: 1829
    ENTRUST_AUTHCA_MANAGER_PORT: 1709
    ENTRUST_AUTHCA_ASH_PORT: 1710
    ENTRUST_AUTHCA_XAP_PORT: 1443
    ENTRUST_AUTHCA_SEARCH_BASE: CN=DOCKER_SUBCA,ou=CA,o=nhs
    ENTRUST_CCCA_CA_PORT: 2829
    ENTRUST_CCCA_MANAGER_PORT: 2709
    ENTRUST_CCCA_ASH_PORT: 2710
    ENTRUST_CCCA_XAP_PORT: 2443
    ENTRUST_CCCA_SEARCH_BASE: DOCKER_SUBCC,ou=CA,o=nhs
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  image: ${registry_url}/cis-cms-business:${app_version}
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - Directory:Directory
  - Entrust-CA1-Manager:Entrust-CA1-Manager
  - Entrust-CA2-Manager:Entrust-CA2-Manager
  - Entrust-CA3-Manager:Entrust-CA3-Manager

EPR-BusinessService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: EPR-BusinessService
    project.service.name: epr-business-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 350000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-epr-business:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

UID-Service:
  image: ${registry_url}/cis-urs-uid:${app_version}
  tty: true
  stdin_open: true
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: UID-Service
    project.service.name: uid-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

URS-BusinessService:
  image: ${registry_url}/cis-urs-business:${app_version}
  tty: true
  stdin_open: true
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: URS-BusinessService
    project.service.name: urs-business-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 7491026944
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  - /home/rancher/env_config/${env_shortcode}/secaudit/client:/home/iam_user/secaudcertificates/client
  privileged: true
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    GLUSTER_PHOTOS: 'true'
    GLUSTER_REPORTS: 'true'
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - LB-Secure:LB-Secure

Integration:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: Integration
    project.service.name: integration
    project.name: cis-urs
    project.stack: urs
  mem_limit: 2147483648
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-integration:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

OMS-BusinessService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: OMS-BusinessService
    project.service.name: oms-business-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-oms-business:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - LB-Secure:LB-Secure

OSCAR-BusinessService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: OSCAR-BusinessService
    project.service.name: oscar-business-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-oscar-business:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

RulesService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: RulesService
    project.service.name: rules-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-rules:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

SecureAudit:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: SecureAudit
    project.service.name: secure-audit
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  - /home/rancher/env_config/${env_shortcode}/secaudit/server:/home/iam_user/secaudcertificates/server
  image: ${registry_url}/cis-secureaudit:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

Scheduler:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: Scheduler
    project.service.name: scheduler
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/quartz.properties:/home/iam_user/careidconfig/quartz.properties
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-scheduler:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

ID-StoreSyncService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: ID-StoreSyncService
    project.service.name: id-store-sync-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 2147483648
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-id-storesync:${app_version}
  tty: true
  stdin_open: true
  environment:
    OPENIDM_OPTS: -Xmx2048m -Xms512m -Dfile.encoding=UTF-8
    OPENIDM_PORT: '389'
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - Directory:Directory

CC-CheckerService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: CC-CheckerService
    project.service.name: cc-checker-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  image: ${registry_url}/cis-ccc:${app_version}
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - Directory:Directory

ReportingService:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: ReportingService
    project.service.name: reporting-service
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-reporting:${app_version}
  tty: true
  stdin_open: true
  privileged: true
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    GLUSTER_REPORTS: 'true'
    JAVA_OPTS: -server -Xms256m -Xmx512m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices

SCEP:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: SCEP
    project.service.name: scep
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  environment:
    CMS_SERVICE_URL: http://LB-BusinessServices:8080/cmsbusservice/rest/cms/
    PKI_URL: https://wfe.${env_shortcode}.iam.spine2.ncrs.nhs.uk/scep/pkiclient.exe
    RETURN_URL: https://wfe.${env_shortcode}.iam.spine2.ncrs.nhs.uk/scep/
  tty: true
  image: ${registry_url}/cis-scep:${app_version}
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices


EPR-WebFrontEnd:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: EPR-WebFrontEnd
    project.service.name: epr-web-frontend
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-epr-webfrontend:${app_version}
  environment:
    JAVA_OPTS: -server -Xms128m -Xms256m -XX:NewSize=128m -XX:MaxNewSize=256m -XX:PermSize=64m -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC  -XX:+UseParNewGC   -XX:ParallelGCThreads=2 -Djava.security.egd=file:/dev/./urandom
  tty: true
  stdin_open: true
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - WebSessionStore:RedisSessionStore

URS-WebFrontEnd:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: URS-WebFrontEnd
    io.rancher.container.dns: true
    project.service.name: urs-web-frontend
    project.name: cis-urs
    project.stack: urs
  mem_limit: 5591026944
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-urs-webfrontend:${app_version}
  tty: true
  stdin_open: true
  privileged: true
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    GLUSTER_PHOTOS: true
    GLUSTER_REPORTS: true
    JAVA_OPTS: -server -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:ParallelGCThreads=2 -Xms512m -Xmx1500m
  links:
  - IAM-Database:IAM-Database
  - LB-BusinessServices:LB-BusinessServices
  - WebSessionStore:RedisSessionStore

Portal:
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: Portal
    io.rancher.container.dns: true
    project.service.name: portal
    project.name: cis-urs
    project.stack: urs
  mem_limit: 250000000
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  image: ${registry_url}/cis-portal:${app_version}
  tty: true
  stdin_open: true
  privileged: true
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    GLUSTER_PHOTOS: true
    GLUSTER_REPORTS: true
    JAVA_OPTS: -server -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:ParallelGCThreads=2 -Xms512m -Xmx1500m
  links:
  - WebSessionStore:RedisSessionStore

haproxy-fe:
  net: "host"
  labels:
    io.rancher.scheduler.global: 'true'
    io.rancher.container.hostname_override: container_name
    io.rancher.container.dns: true
    io.rancher.sidekicks: keepalived-fe
    environment_name: ${env_shortcode}
    service_name: haproxy-fe
    project.service.name: haproxy-fe
    project.name: cis-urs
    project.stack: urs
  volumes:
  - /home/rancher:/mnt/gluster
  links:
  - URS-WebFrontEnd:${env_shortcode}-URS-WebFrontEnd
  - EPR-WebFrontEnd:${env_shortcode}-EPR-WebFrontEnd
  - Integration:${env_shortcode}-Integration
  - Portal:${env_shortcode}-Portal
  - SelfService-WebFrontEnd:${env_shortcode}-SelfService-WebFrontEnd
  environment:
    - fe1ip=$VIP_ONE
    - fe2ip=$VIP_TWO
    - fe3ip=$VIP_THREE
    - fe4ip=$VIP_FOUR
    - fe1pemfile=$VIP_ONE_PEM
    - fe2pemfile=$VIP_TWO_PEM
    - fe3pemfile=$VIP_THREE_PEM
    - fe4pemfile=$VIP_FOUR_PEM
    - be1-1fqdn=$VIP_ONE_ONE_BE
    - be1-2fqdn=$VIP_ONE_TWO_BE
    - be1-3fqdn=$VIP_ONE_THREE_BE
    - be1-4fqdn=$VIP_ONE_FOUR_BE
    - be1-5fqdn=$VIP_ONE_FIVE_BE
    - be2fqdn=$VIP_TWO_BE
    - be3fqdn=$VIP_THREE_BE
    - be4fqdn=$VIP_FOUR_BE	
    - GLUSTER_URL=${gluster_url}
    - envcode=${env_shortcode}
  image: ${registry_url}/cis-fe-haproxy
  tty: true
  stdin_open: true
  privileged: true

keepalived-fe:
  net: "host"
  labels:
    io.rancher.scheduler.global: 'true'
    io.rancher.container.hostname_override: container_name
    io.rancher.container.dns: true
    environment_name: ${env_shortcode}
    service_name: keepalived-fe
    project.service.name: keepalived-fe
    project.name: cis-urs
    project.stack: urs
  environment:
    - fe1ip=$VIP_ONE
    - fe2ip=$VIP_TWO
    - fe3ip=$VIP_THREE
    - fe4ip=$VIP_FOUR
    - interface=$VIP_INTERFACE
    - vrid=$VIP_VRID
    - envcode=${env_shortcode}
  image: ${registry_url}/cis-fe-keepalived
  tty: true
  stdin_open: true
  cap_add:
    - NET_ADMIN
    - NET_BROADCAST

SelfService-WebFrontEnd:
  environment:
    GLUSTER_URL: ${gluster_url}
    GLUSTER_FOLDER: ${env_shortcode}
    GLUSTER_PHOTOS: true
    GLUSTER_REPORTS: true
    JAVA_OPTS: -server -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:ParallelGCThreads=2 -Xms512m -Xmx1500m
  labels:
    environment_name: lh
    io.rancher.container.hostname_override: container_name
    service_name: SelfService-WebFrontEnd
    project.service.name: selfservice-webfrontend
    project.name: cis-urs
    project.stack: urs
    io.rancher.container.dns: 'true'
  links:
    - WebSessionStore:RedisSessionStore
  tty: true
  log_opt: {}
  image: ${registry_url}/cis-selfservice-webfrontend:latest
  privileged: true
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  stdin_open: true
  mem_limit: 5591026944
  
EmailService:
  image: ${registry_url}/cis-emailservice:${app_version}
  tty: true
  stdin_open: true
  labels:
    io.rancher.container.hostname_override: container_name
    environment_name: ${env_shortcode}
    service_name: EmailService
    project.service.name: emailservice
    project.name: cis-urs
    project.stack: urs
  mem_limit: 7491026944
  volumes:
  - /var/log/iam:/var/log/iam
  - /home/rancher/env_config/${env_shortcode}/services.properties:/home/iam_user/careidconfig/services.properties
  privileged: true
  links:
  - LB-BusinessServices:LB-BusinessServices
